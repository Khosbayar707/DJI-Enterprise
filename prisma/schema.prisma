generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id String @id @unique @default(nanoid())
  email String  @unique
  password String
  isAdmin Boolean @default(false)
  sub_news Boolean @default(false)
  isActive Boolean @default(true)
  drones Drone[]
  specs Spec[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
}

model Drone {
  id String @id @default(nanoid()) @unique
  name String
  weight String @default("Жин оруулаагүй.")
  model DroneModel? @relation(fields: [modelId], references: [id])
  modelId String?
  Price Int?
  description String @default("Дэлгэрэнгүй мэдээлэл алга!")
  categories DroneCategory[]
  featuredImage Image? @relation("DroneFeaturedImage", fields: [featuredImageId], references: [id]) 
  featuredImageId String? @unique
  featuredVideo Video? @relation("DroneFeaturedVideo", fields: [featuredVideoId], references: [id]) 
  featuredVideoId String? @unique
  images Image[]
  videos Video[] @relation("videos")
  admin User @relation(fields: [adminId], references: [id])
  adminId String
  visible Boolean @default(false)
  specs Spec[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
}

model DroneModel {
  id String @default(nanoid()) @unique @id
  name String
  drones Drone[]
}

model Spec {
  id String @id @unique @default(nanoid())
  name String
  detail String
  specCategories SpecCategory[]
  droneId String?
  admin User @relation(fields: [adminId], references: [id])
  adminId String
  drone Drone? @relation(fields: [droneId], references: [id])
  visible Boolean @default(false)
  image Image[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
}

model DroneCategory {
  id String @id @default(nanoid()) @unique
  name String
  drones Drone[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
}

model SpecCategory {
  id String @id @default(nanoid()) @unique
  name String
  specs Spec[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
}

model Image {
  id String @id @default(nanoid()) @unique
  name String @default("Нэр өгөөгүй!")
  description String @default("Дэлгэрэнгүй мэдээлэл оруулаагүй байна!")
  url String
  public_id String
  priority Int @default(0)
  drone Drone? @relation(references: [id], fields: [droneId])
  droneId String?
  spec Spec? @relation(references: [id], fields: [specId])
  specId String?
  DroneFeaturedImage Drone? @relation("DroneFeaturedImage") 
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
}

model Video {
  id String @id @default(nanoid()) @unique
  url String
  droneFeaturedVideo Drone? @relation("DroneFeaturedVideo") 
  drone Drone @relation("videos",references: [id], fields: [droneId])
  droneId String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
}